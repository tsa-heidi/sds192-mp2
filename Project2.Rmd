---
title: "Project2"
output: html_document
author: Heidi, Harriet, Viola 
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

```{r}
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
library(tidyverse)
library(dplyr)
library(ggrepel)
```

Modifying Candidates
```{r}
candidates_NY2012 <- candidates %>%
  filter(cand_office_state == "NY")%>%
  filter(cand_party_affiliation == "DEM") %>%
  filter(cand_election_yr == 2012)
candidates_NY2012
```



Modifying Contributions
```{r}
cand_IDs <- select(candidates_NY2012, matches("cand_id"))

contributions_NY <- filter(contributions, cand_id %in% cand_IDs$cand_id)

contributions_NY <- contributions_NY %>%
  select(cand_id, transaction_amt)
contributions_NY

candidates_NY2012 <- select(candidates_NY2012, cand_id, cand_name)
```




Modifying house_elections
```{r}
house_elections_NY2012 <- house_elections %>%
  select(fec_id, ge_winner)
```

joining contributions and candidates
```{r}
contr_cand_joined <- full_join(contributions_NY, candidates_NY2012, by= "cand_id")
contr_cand_joined <- contr_cand_joined %>%
  group_by(cand_id, cand_name) %>%
  summarise(sum = sum(transaction_amt)) %>%
  arrange(sum)
contr_cand_joined
```




filter and modify house elections
```{r}
house_elections_NY2012 <- filter(house_elections_NY2012, fec_id %in% contr_cand_joined$cand_id)
house_elections_NY2012 <- mutate(house_elections_NY2012, cand_id = fec_id )
```


```{r}


final_df <- inner_join(contr_cand_joined, house_elections_NY2012, by = "cand_id")
final_df <- select(final_df,cand_name, sum, ge_winner)
final_df <- final_df %>%
  arrange(ge_winner)

```



```{r}

my_plot <- ggplot(data= final_df, aes(x = cand_id, y = sum, fill = ge_winner))+
  geom_histogram(stat = "identity")
my_plot + theme(axis.text.x = element_text(angle = 90))
```



